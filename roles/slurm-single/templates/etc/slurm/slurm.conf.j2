# slurm.conf file generated by river computing (nttg8100@gmail.com)
ClusterName=rivercomputing
SlurmctldHost=localhost
MpiDefault=none
ReturnToService=2
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmctldPort=6817
SlurmdPidFile=/var/run/slurmd.pid
SlurmdPort=6818
SlurmdSpoolDir= {{ slurm_spool_dir | default('/var/spool/slurmd') }}
SlurmUser=slurm
StateSaveLocation= {{ slurm_state_save_location |default('/var/lib/slurm/slurmctld')}}
SwitchType=switch/none
#
# TIMERS
InactiveLimit=0
KillWait=30
MinJobAge=300
SlurmctldTimeout=120
SlurmdTimeout=300
Waittime=0
# SCHEDULING
SchedulerType=sched/backfill
SelectType={{slurm_selecttype|default('select/cons_tres')}}
SelectTypeParameters={{slurm_selecttypeparameters|default('CR_Core_Memory')}}
DefMemPerCPU={{slurm_defmempercpu|int}}
#
AccountingStorageType=accounting_storage/none
JobCompType=jobcomp/none
JobAcctGatherFrequency=30
JobAcctGatherType = jobacct_gather/cgroup
ProctrackType = proctrack/cgroup
TaskPlugin=affinity,cgroup
DebugFlags=cgroup
SlurmdDebug=debug

SlurmctldDebug=info
SlurmctldLogFile= {{ slurm_log_dir | default('/var/log/slurm')}}/slurmctld.log
SlurmdLogFile= {{ slurm_log_dir | default('/var/log/slurm')}}/slurmd.log
#
# COMPUTE NODES
NodeName=localhost RealMemory={{ansible_memtotal_mb|int - 384}} CPUs={{ansible_processor_vcpus}} Sockets={{ansible_processor_count}} CoresPerSocket={{(ansible_processor_vcpus/ansible_processor_count)|int}} ThreadsPerCore={{ansible_processor_threads_per_core}} {{gpu_info}} 
PartitionName=LocalQ Nodes=ALL Default=YES State=UP MaxTime={{slurm_max_job_time|default('48:00:00')}} DefaultTime={{slurm_def_job_time|default('04:00:00')}}
